SELECT 
    DATE(s.created_at) AS session_date,
    COUNT(DISTINCT s.username) AS total_unique_users,
    COUNT(sh.history_id) AS total_queries
FROM 
    session s
JOIN 
    session_history sh ON s.session_id = sh.session_id
WHERE 
    sh.user_type = 'user'
GROUP BY 
    DATE(s.created_at)
ORDER BY 
    session_date;
